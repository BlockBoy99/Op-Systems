#include "dispatch.h"

#include <pcap.h>

#include "analysis.h"
#include <netinet/if_ether.h>
void dispatch(u_char *user, const struct pcap_pkthdr *header,
              const u_char *packet) {

    int verbose = *(int *)user; //retrieve verbose correctly
    enqueue_packet(header, packet, verbose); //enqueue packets for worker threads
}

// ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⣾⣿⣿⣿⣶⣦⡀⠀⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⠀⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣿⡏⠈⣿⣿⣿⣿⠀⣿⣿⣇⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠿⣿⣿⣷⣶⣿⣿⣿⣿⣶⣿⣿⣿⠀⠀⠀⠀⠀
// ⠀⠀⠀⠀⢀⣠⣶⣾⣿⣿⣿⣶⣤⡈⠙⢿⣿⠉⠀⠀⠙⣿⣿⣿⣿⠀⠀⠀⠀⠀
// ⠀⠀⠀⣠⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣆⠈⢿⣷⣶⣶⣾⣿⣿⣿⣿⠀⠀⠀⠀⠀
// ⠀⠀⢠⣿⣿⣿⡇⠈⣿⣿⣿⡏⠀⣿⣿⡆⠈⠋⢉⣀⣀⣀⣈⠉⠉⠀⠀⠀⠀⠀
// ⠀⠀⢸⣿⣿⣿⣷⣶⣿⣿⣿⣿⣶⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣶⣄⠀⠀⠀⠀
// ⠀⠀⢸⣿⣿⣿⣿⣿⠁⠀⠀⢹⣿⡟⢀⣾⣿⣿⡿⢿⣿⣿⣿⡿⢿⣿⣧⠀⠀⠀
// ⠀⠀⢸⣿⣿⣿⣿⣿⣷⣶⣶⣿⣿⠁⢸⣿⣿⣿⡇⢸⣿⣿⣿⡇⢀⣿⣿⡆⠀⠀
// ⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⢸⣿⣿⣿⣿⣿⠿⠿⠿⣿⣿⣿⣿⡇⠀⠀
// ⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⢸⣿⣿⣿⣿⣧⡀⠀⢀⣼⣿⣿⣿⡇⠀⠀
// ⠀⠀⠘⠿⠿⠿⠿⠿⠿⠿⠿⠿⠿⠀⠸⠿⠿⠿⠿⠿⠿⠿⠿⠿⠿⠿⠿⠃⠀⠀
// ⠀⣠⣴⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣦⣄⠀
// ⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷
// ⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿